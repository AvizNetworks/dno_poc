<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>vasn_tap Integration Test Report</title>
<style>
  :root {
    --bg: #f5f7fa;
    --card-bg: #ffffff;
    --text: #1a1a2e;
    --text-muted: #6b7280;
    --border: #e5e7eb;
    --pass-bg: #ecfdf5;
    --pass-text: #065f46;
    --pass-border: #6ee7b7;
    --pass-badge: #059669;
    --fail-bg: #fef2f2;
    --fail-text: #991b1b;
    --fail-border: #fca5a5;
    --fail-badge: #dc2626;
    --header-bg: #1e293b;
    --header-text: #f1f5f9;
    --accent: #3b82f6;
    --table-header: #f9fafb;
    --topology-bg: #1e293b;
    --topology-text: #a5f3fc;
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    background: var(--bg);
    color: var(--text);
    line-height: 1.6;
  }
  .header {
    background: var(--header-bg);
    color: var(--header-text);
    padding: 24px 32px;
  }
  .header h1 { font-size: 24px; font-weight: 700; margin-bottom: 4px; }
  .header .subtitle { font-size: 14px; opacity: 0.7; }
  .header .meta {
    display: flex; flex-wrap: wrap; gap: 20px;
    margin-top: 12px; font-size: 13px; opacity: 0.85;
  }
  .header .meta span { display: flex; align-items: center; gap: 4px; }
  .container { max-width: 1100px; margin: 0 auto; padding: 24px 16px; }

  /* Summary bar */
  .summary {
    display: flex; gap: 16px; margin-bottom: 24px; flex-wrap: wrap;
  }
  .summary-card {
    flex: 1; min-width: 140px;
    background: var(--card-bg);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 16px 20px;
    text-align: center;
  }
  .summary-card .label { font-size: 12px; text-transform: uppercase; color: var(--text-muted); letter-spacing: 0.5px; }
  .summary-card .value { font-size: 28px; font-weight: 700; margin-top: 4px; }
  .summary-card.total .value { color: var(--accent); }
  .summary-card.passed .value { color: var(--pass-badge); }
  .summary-card.failed .value { color: var(--fail-badge); }
  .summary-card.overall { border-width: 2px; }
  .summary-card.overall.pass { border-color: var(--pass-border); background: var(--pass-bg); }
  .summary-card.overall.fail { border-color: var(--fail-border); background: var(--fail-bg); }
  .summary-card.overall .value.pass { color: var(--pass-badge); }
  .summary-card.overall .value.fail { color: var(--fail-badge); }

  /* Topology */
  .topology {
    background: var(--topology-bg);
    border-radius: 10px;
    padding: 20px 24px;
    margin-bottom: 24px;
    overflow-x: auto;
  }
  .topology h3 { color: #94a3b8; font-size: 13px; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 12px; }
  .topology pre {
    color: var(--topology-text);
    font-family: 'SF Mono', 'Fira Code', 'Cascadia Code', monospace;
    font-size: 13px;
    line-height: 1.5;
    white-space: pre;
  }

  /* Test cards */
  .test-card {
    background: var(--card-bg);
    border: 1px solid var(--border);
    border-radius: 10px;
    margin-bottom: 16px;
    overflow: hidden;
    transition: box-shadow 0.15s;
  }
  .test-card:hover { box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
  .test-card.pass { border-left: 4px solid var(--pass-badge); }
  .test-card.fail { border-left: 4px solid var(--fail-badge); }

  .test-header {
    display: flex; justify-content: space-between; align-items: center;
    padding: 16px 20px;
    cursor: pointer;
  }
  .test-header h3 { font-size: 16px; font-weight: 600; }
  .test-header .desc { font-size: 13px; color: var(--text-muted); margin-top: 2px; }

  .badge {
    display: inline-block;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    white-space: nowrap;
  }
  .badge.pass { background: var(--pass-bg); color: var(--pass-badge); border: 1px solid var(--pass-border); }
  .badge.fail { background: var(--fail-bg); color: var(--fail-badge); border: 1px solid var(--fail-border); }

  .test-body { padding: 0 20px 20px; }
  .test-body .section-title {
    font-size: 11px; text-transform: uppercase; color: var(--text-muted);
    letter-spacing: 0.8px; margin: 16px 0 8px; font-weight: 600;
  }

  .detail-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 12px;
  }
  .detail-item {
    background: var(--table-header);
    border-radius: 8px;
    padding: 12px 16px;
  }
  .detail-item .label { font-size: 11px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; }
  .detail-item .val { font-size: 18px; font-weight: 600; margin-top: 2px; }
  .detail-item .val.highlight { color: var(--accent); }

  table.info-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 14px;
    margin-top: 4px;
  }
  table.info-table th {
    text-align: left;
    padding: 8px 12px;
    background: var(--table-header);
    color: var(--text-muted);
    font-weight: 600;
    font-size: 12px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    border-bottom: 1px solid var(--border);
  }
  table.info-table td {
    padding: 8px 12px;
    border-bottom: 1px solid var(--border);
  }

  .error-box {
    background: var(--fail-bg);
    border: 1px solid var(--fail-border);
    border-radius: 8px;
    padding: 12px 16px;
    margin-top: 12px;
    font-size: 13px;
    color: var(--fail-text);
  }
  .error-box .error-label { font-weight: 700; margin-bottom: 4px; }

  .note-box {
    background: #eff6ff;
    border: 1px solid #93c5fd;
    border-radius: 8px;
    padding: 12px 16px;
    margin-top: 12px;
    font-size: 13px;
    color: #1e40af;
    line-height: 1.5;
  }
  .note-box .note-label { font-weight: 700; margin-bottom: 4px; }

  .detail-item .sublabel {
    font-size: 10px;
    color: var(--text-muted);
    margin-top: 2px;
    font-weight: 400;
    line-height: 1.3;
  }

  .footer {
    text-align: center;
    padding: 20px;
    font-size: 12px;
    color: var(--text-muted);
  }

  /* Collapsible */
  .test-body { display: none; }
  .test-card.open .test-body { display: block; }
  .toggle-icon { transition: transform 0.2s; font-size: 14px; color: var(--text-muted); }
  .test-card.open .toggle-icon { transform: rotate(90deg); }
</style>
</head>
<body>
<div class="header">
  <h1>vasn_tap Integration Test Report</h1>
  <div class="subtitle">Automated packet tap testing results</div>
  <div class="meta">
    <span>Date: 2026-02-16 16:09:20 UTC</span>
    <span>Host: asn-dev-100g</span>
    <span>Kernel: 5.15.0-170-generic</span>
    <span>Arch: x86_64</span>
  </div>
</div>
<div class="container">
  <div class="summary">
    <div class="summary-card total">
      <div class="label">Total Tests</div>
      <div class="value">22</div>
    </div>
    <div class="summary-card passed">
      <div class="label">Passed</div>
      <div class="value">20</div>
    </div>
    <div class="summary-card failed">
      <div class="label">Failed</div>
      <div class="value">2</div>
    </div>
    <div class="summary-card">
      <div class="label">Duration</div>
      <div class="value">131s</div>
    </div>
    <div class="summary-card overall fail">
      <div class="label">Status</div>
      <div class="value fail">2 FAILED</div>
    </div>
  </div>
  <div class="topology">
    <h3>Test Topology</h3>
    <pre>
    [ns_src]                      [default ns]                      [ns_dst]
    192.168.200.1/24                                                     192.168.201.1/24

    +--------------+         +------------------+          +--------------+
    | veth_src_ns  |--veth--&gt;| veth_src_host    |          | veth_dst_ns  |
    +--------------+         |                  |          +--------------+
                             |    vasn_tap      |                ^
                             |  -i veth_src_host|                |
                             |  -o veth_dst_host|          +-----+--------+
                             |                  |--veth--&gt;| veth_dst_host |
                             +------------------+          +--------------+

    Traffic flow: ns_src --ping--&gt; veth_src_host --vasn_tap--&gt; veth_dst_host --&gt; ns_dst
    </pre>
  </div>

  <div class="test-card pass" onclick="this.classList.toggle('open')">
    <div class="test-header">
      <div>
        <h3>Basic Packet Forwarding (afpacket)</h3>
        <div class="desc">Send 20 ICMP pings from ns_src through vasn_tap to ns_dst and verify packets are forwarded</div>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="badge pass">PASS</span>
        <span class="toggle-icon">&#9654;</span>
      </div>
    </div>
    <div class="test-body">
      <div class="section-title">Configuration</div>
      <table class="info-table">
        <tr><th>Capture Mode</th><th>Workers</th><th>Input Interface</th><th>Output Interface</th></tr>
        <tr><td>afpacket</td><td>2</td><td>veth_src_host</td><td>veth_dst_host</td></tr>
      </table>

      <div class="section-title">Traffic Injected by Test</div>
      <table class="info-table">
        <tr><th>Type</th><th>Pings Sent</th><th>Source</th><th>Destination</th><th>Expected Raw Frames</th></tr>
        <tr><td>ICMP ping</td><td>20</td><td>ns_src (192.168.200.1)</td><td>host (192.168.200.2)</td><td>~50 (requests + replies + ARP)</td></tr>
      </table>

      <div class="section-title">Results</div>
      <div class="detail-grid">
        <div class="detail-item">
          <div class="label">Raw Frames Captured</div>
          <div class="val highlight">48</div>
          <div class="sublabel">All frames on input iface (both directions + ARP)</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Forwarded</div>
          <div class="val highlight">48</div>
          <div class="sublabel">Frames sent to output interface by vasn_tap</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Dropped</div>
          <div class="val">0</div>
          <div class="sublabel">Captured but not forwarded (no output or error)</div>
        </div>
        <div class="detail-item">
          <div class="label">Received at Destination</div>
          <div class="val">20</div>
          <div class="sublabel">Packets verified by tcpdump in ns_dst</div>
        </div>
        <div class="detail-item">
          <div class="label">Duration</div>
          <div class="val">5s</div>
        </div>
      </div>
      <div class="note-box">
        <div class="note-label">Why do the numbers differ from pings sent?</div>
        <div>AF_PACKET RX counts all raw frames on the input interface (both directions: echo requests + echo replies + ARP). Sent 20 pings, but AF_PACKET sees ~20x2 ICMP frames plus ARP overhead.</div>
      </div>
    </div>
  </div>

  <div class="test-card pass" onclick="this.classList.toggle('open')">
    <div class="test-header">
      <div>
        <h3>Basic Packet Forwarding (ebpf)</h3>
        <div class="desc">Send 20 ICMP pings from ns_src through vasn_tap to ns_dst and verify packets are forwarded</div>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="badge pass">PASS</span>
        <span class="toggle-icon">&#9654;</span>
      </div>
    </div>
    <div class="test-body">
      <div class="section-title">Configuration</div>
      <table class="info-table">
        <tr><th>Capture Mode</th><th>Workers</th><th>Input Interface</th><th>Output Interface</th></tr>
        <tr><td>ebpf</td><td>2</td><td>veth_src_host</td><td>veth_dst_host</td></tr>
      </table>

      <div class="section-title">Traffic Injected by Test</div>
      <table class="info-table">
        <tr><th>Type</th><th>Pings Sent</th><th>Source</th><th>Destination</th><th>Expected Raw Frames</th></tr>
        <tr><td>ICMP ping</td><td>20</td><td>ns_src (192.168.200.1)</td><td>host (192.168.200.2)</td><td>~50 (requests + replies + ARP)</td></tr>
      </table>

      <div class="section-title">Results</div>
      <div class="detail-grid">
        <div class="detail-item">
          <div class="label">Raw Frames Captured</div>
          <div class="val highlight">40</div>
          <div class="sublabel">All frames on input iface (both directions + ARP)</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Forwarded</div>
          <div class="val highlight">40</div>
          <div class="sublabel">Frames sent to output interface by vasn_tap</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Dropped</div>
          <div class="val">0</div>
          <div class="sublabel">Captured but not forwarded (no output or error)</div>
        </div>
        <div class="detail-item">
          <div class="label">Received at Destination</div>
          <div class="val">20</div>
          <div class="sublabel">Packets verified by tcpdump in ns_dst</div>
        </div>
        <div class="detail-item">
          <div class="label">Duration</div>
          <div class="val">5s</div>
        </div>
      </div>
      <div class="note-box">
        <div class="note-label">Why do the numbers differ from pings sent?</div>
        <div>eBPF mode uses TC hook + perf buffer. RX count reflects packets delivered by the perf buffer to userspace. Count depends on TC hook direction and kernel behavior.</div>
      </div>
    </div>
  </div>

  <div class="test-card pass" onclick="this.classList.toggle('open')">
    <div class="test-header">
      <div>
        <h3>Drop Mode - afpacket</h3>
        <div class="desc">Capture 20 ICMP pings in afpacket mode with no output interface. Verify RX counts packets, TX stays zero, and dropped counter increments.</div>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="badge pass">PASS</span>
        <span class="toggle-icon">&#9654;</span>
      </div>
    </div>
    <div class="test-body">
      <div class="section-title">Configuration</div>
      <table class="info-table">
        <tr><th>Capture Mode</th><th>Workers</th><th>Input Interface</th><th>Output Interface</th></tr>
        <tr><td>afpacket</td><td>2</td><td>veth_src_host</td><td>(none - drop mode)</td></tr>
      </table>

      <div class="section-title">Traffic Injected by Test</div>
      <table class="info-table">
        <tr><th>Type</th><th>Pings Sent</th><th>Source</th><th>Destination</th><th>Expected Raw Frames</th></tr>
        <tr><td>ICMP ping</td><td>20</td><td>ns_src (192.168.200.1)</td><td>host (192.168.200.2)</td><td>~50 (requests + replies + ARP)</td></tr>
      </table>

      <div class="section-title">Results</div>
      <div class="detail-grid">
        <div class="detail-item">
          <div class="label">Raw Frames Captured</div>
          <div class="val highlight">42</div>
          <div class="sublabel">All frames on input iface (both directions + ARP)</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Forwarded</div>
          <div class="val highlight">0</div>
          <div class="sublabel">Frames sent to output interface by vasn_tap</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Dropped</div>
          <div class="val">42</div>
          <div class="sublabel">Captured but not forwarded (no output or error)</div>
        </div>
        <div class="detail-item">
          <div class="label">Received at Destination</div>
          <div class="val">0</div>
          <div class="sublabel">Packets verified by tcpdump in ns_dst</div>
        </div>
        <div class="detail-item">
          <div class="label">Duration</div>
          <div class="val">5s</div>
        </div>
      </div>
      <div class="note-box">
        <div class="note-label">Why do the numbers differ from pings sent?</div>
        <div>No output interface configured -- all captured frames are counted as dropped. AF_PACKET RX includes both directions (requests + replies) plus ARP overhead.</div>
      </div>
    </div>
  </div>

  <div class="test-card pass" onclick="this.classList.toggle('open')">
    <div class="test-header">
      <div>
        <h3>Drop Mode - ebpf</h3>
        <div class="desc">Capture 20 ICMP pings in ebpf mode with no output interface. Verify RX counts packets, TX stays zero, and dropped counter increments.</div>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="badge pass">PASS</span>
        <span class="toggle-icon">&#9654;</span>
      </div>
    </div>
    <div class="test-body">
      <div class="section-title">Configuration</div>
      <table class="info-table">
        <tr><th>Capture Mode</th><th>Workers</th><th>Input Interface</th><th>Output Interface</th></tr>
        <tr><td>ebpf</td><td>2</td><td>veth_src_host</td><td>(none - drop mode)</td></tr>
      </table>

      <div class="section-title">Traffic Injected by Test</div>
      <table class="info-table">
        <tr><th>Type</th><th>Pings Sent</th><th>Source</th><th>Destination</th><th>Expected Raw Frames</th></tr>
        <tr><td>ICMP ping</td><td>20</td><td>ns_src (192.168.200.1)</td><td>host (192.168.200.2)</td><td>~50 (requests + replies + ARP)</td></tr>
      </table>

      <div class="section-title">Results</div>
      <div class="detail-grid">
        <div class="detail-item">
          <div class="label">Raw Frames Captured</div>
          <div class="val highlight">40</div>
          <div class="sublabel">All frames on input iface (both directions + ARP)</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Forwarded</div>
          <div class="val highlight">0</div>
          <div class="sublabel">Frames sent to output interface by vasn_tap</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Dropped</div>
          <div class="val">40</div>
          <div class="sublabel">Captured but not forwarded (no output or error)</div>
        </div>
        <div class="detail-item">
          <div class="label">Received at Destination</div>
          <div class="val">0</div>
          <div class="sublabel">Packets verified by tcpdump in ns_dst</div>
        </div>
        <div class="detail-item">
          <div class="label">Duration</div>
          <div class="val">4s</div>
        </div>
      </div>
      <div class="note-box">
        <div class="note-label">Why do the numbers differ from pings sent?</div>
        <div>No output interface configured -- all captured frames are counted as dropped. eBPF perf buffer delivers packets matching the TC hook.</div>
      </div>
    </div>
  </div>

  <div class="test-card pass" onclick="this.classList.toggle('open')">
    <div class="test-header">
      <div>
        <h3>Fanout Distribution</h3>
        <div class="desc">Verify PACKET_FANOUT_HASH distributes 8 UDP flows across 4 AF_PACKET worker threads and packets reach ns_dst</div>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="badge pass">PASS</span>
        <span class="toggle-icon">&#9654;</span>
      </div>
    </div>
    <div class="test-body">
      <div class="section-title">Configuration</div>
      <table class="info-table">
        <tr><th>Capture Mode</th><th>Workers</th><th>Input Interface</th><th>Output Interface</th></tr>
        <tr><td>afpacket</td><td>4</td><td>veth_src_host</td><td>veth_dst_host</td></tr>
      </table>

      <div class="section-title">Traffic Injected by Test</div>
      <table class="info-table">
        <tr><th>Type</th><th>Pings Sent</th><th>Source</th><th>Destination</th><th>Expected Raw Frames</th></tr>
        <tr><td>iperf3 UDP (8 streams x 1M/stream, -l 1470)</td><td>8</td><td>ns_src (192.168.200.1)</td><td>host (192.168.200.2)</td><td>~26 (requests + replies + ARP)</td></tr>
      </table>

      <div class="section-title">Results</div>
      <div class="detail-grid">
        <div class="detail-item">
          <div class="label">Raw Frames Captured</div>
          <div class="val highlight">3454</div>
          <div class="sublabel">All frames on input iface (both directions + ARP)</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Forwarded</div>
          <div class="val highlight">3454</div>
          <div class="sublabel">Frames sent to output interface by vasn_tap</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Dropped</div>
          <div class="val">0</div>
          <div class="sublabel">Captured but not forwarded (no output or error)</div>
        </div>
        <div class="detail-item">
          <div class="label">Received at Destination</div>
          <div class="val">3454</div>
          <div class="sublabel">Packets verified by tcpdump in ns_dst</div>
        </div>
        <div class="detail-item">
          <div class="label">Duration</div>
          <div class="val">11s</div>
        </div>
      </div>
      <div class="note-box">
        <div class="note-label">Why do the numbers differ from pings sent?</div>
        <div>Fanout test sends 8 parallel UDP streams at 1M/stream, -l 1470 (iperf3 -u -P 8 -b 1M -l 1470) for 5s to create distinct 5-tuples. PACKET_FANOUT_HASH distributes flows by hashing src/dst IP + ports + protocol. Per-worker breakdown: [W0:RX=1284, W1:RX=886, W2:RX=856, W3:RX=428]. 4 of 4 workers received packets. A single flow (e.g. one ping) always goes to one worker -- multiple flows are needed to prove distribution. captured_at_dst must be >= 80% of TX (packets seen in ns_dst via tcpdump on veth_dst_ns).</div>
      </div>
    </div>
  </div>

  <div class="test-card pass" onclick="this.classList.toggle('open')">
    <div class="test-header">
      <div>
        <h3>Filter (drop all) - AF_PACKET</h3>
        <div class="desc">ACL default_action=drop, rules=[]. Expect TX=0, Dropped>0.</div>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="badge pass">PASS</span>
        <span class="toggle-icon">&#9654;</span>
      </div>
    </div>
    <div class="test-body">
      <div class="section-title">Configuration</div>
      <table class="info-table">
        <tr><th>Capture Mode</th><th>Workers</th><th>Input Interface</th><th>Output Interface</th></tr>
        <tr><td>afpacket</td><td>2</td><td>veth_src_host</td><td>veth_dst_host</td></tr>
      </table>

      <div class="section-title">Traffic Injected by Test</div>
      <table class="info-table">
        <tr><th>Type</th><th>Pings Sent</th><th>Source</th><th>Destination</th><th>Expected Raw Frames</th></tr>
        <tr><td>ICMP ping</td><td>20</td><td>n/a</td><td>n/a</td><td>~50 (requests + replies + ARP)</td></tr>
      </table>

      <div class="section-title">Results</div>
      <div class="detail-grid">
        <div class="detail-item">
          <div class="label">Raw Frames Captured</div>
          <div class="val highlight">40</div>
          <div class="sublabel">All frames on input iface (both directions + ARP)</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Forwarded</div>
          <div class="val highlight">0</div>
          <div class="sublabel">Frames sent to output interface by vasn_tap</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Dropped</div>
          <div class="val">40</div>
          <div class="sublabel">Captured but not forwarded (no output or error)</div>
        </div>
        <div class="detail-item">
          <div class="label">Received at Destination</div>
          <div class="val">0</div>
          <div class="sublabel">Packets verified by tcpdump in ns_dst</div>
        </div>
        <div class="detail-item">
          <div class="label">Duration</div>
          <div class="val">4s</div>
        </div>
      </div>
    </div>
  </div>

  <div class="test-card pass" onclick="this.classList.toggle('open')">
    <div class="test-header">
      <div>
        <h3>Filter (allow all) - afpacket</h3>
        <div class="desc">ACL default_action=allow, rules=[]. Expect RX>0, TX>0, Dropped=0.</div>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="badge pass">PASS</span>
        <span class="toggle-icon">&#9654;</span>
      </div>
    </div>
    <div class="test-body">
      <div class="section-title">Configuration</div>
      <table class="info-table">
        <tr><th>Capture Mode</th><th>Workers</th><th>Input Interface</th><th>Output Interface</th></tr>
        <tr><td>afpacket</td><td>2</td><td>veth_src_host</td><td>veth_dst_host</td></tr>
      </table>

      <div class="section-title">Traffic Injected by Test</div>
      <table class="info-table">
        <tr><th>Type</th><th>Pings Sent</th><th>Source</th><th>Destination</th><th>Expected Raw Frames</th></tr>
        <tr><td>ICMP ping</td><td>20</td><td>n/a</td><td>n/a</td><td>~50 (requests + replies + ARP)</td></tr>
      </table>

      <div class="section-title">Results</div>
      <div class="detail-grid">
        <div class="detail-item">
          <div class="label">Raw Frames Captured</div>
          <div class="val highlight">40</div>
          <div class="sublabel">All frames on input iface (both directions + ARP)</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Forwarded</div>
          <div class="val highlight">40</div>
          <div class="sublabel">Frames sent to output interface by vasn_tap</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Dropped</div>
          <div class="val">0</div>
          <div class="sublabel">Captured but not forwarded (no output or error)</div>
        </div>
        <div class="detail-item">
          <div class="label">Received at Destination</div>
          <div class="val">0</div>
          <div class="sublabel">Packets verified by tcpdump in ns_dst</div>
        </div>
        <div class="detail-item">
          <div class="label">Duration</div>
          <div class="val">4s</div>
        </div>
      </div>
    </div>
  </div>

  <div class="test-card pass" onclick="this.classList.toggle('open')">
    <div class="test-header">
      <div>
        <h3>Filter (allow all) - ebpf</h3>
        <div class="desc">ACL default_action=allow, rules=[]. Expect RX>0, TX>0, Dropped=0.</div>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="badge pass">PASS</span>
        <span class="toggle-icon">&#9654;</span>
      </div>
    </div>
    <div class="test-body">
      <div class="section-title">Configuration</div>
      <table class="info-table">
        <tr><th>Capture Mode</th><th>Workers</th><th>Input Interface</th><th>Output Interface</th></tr>
        <tr><td>ebpf</td><td>1</td><td>veth_src_host</td><td>veth_dst_host</td></tr>
      </table>

      <div class="section-title">Traffic Injected by Test</div>
      <table class="info-table">
        <tr><th>Type</th><th>Pings Sent</th><th>Source</th><th>Destination</th><th>Expected Raw Frames</th></tr>
        <tr><td>ICMP ping</td><td>20</td><td>n/a</td><td>n/a</td><td>~50 (requests + replies + ARP)</td></tr>
      </table>

      <div class="section-title">Results</div>
      <div class="detail-grid">
        <div class="detail-item">
          <div class="label">Raw Frames Captured</div>
          <div class="val highlight">41</div>
          <div class="sublabel">All frames on input iface (both directions + ARP)</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Forwarded</div>
          <div class="val highlight">41</div>
          <div class="sublabel">Frames sent to output interface by vasn_tap</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Dropped</div>
          <div class="val">0</div>
          <div class="sublabel">Captured but not forwarded (no output or error)</div>
        </div>
        <div class="detail-item">
          <div class="label">Received at Destination</div>
          <div class="val">0</div>
          <div class="sublabel">Packets verified by tcpdump in ns_dst</div>
        </div>
        <div class="detail-item">
          <div class="label">Duration</div>
          <div class="val">4s</div>
        </div>
      </div>
    </div>
  </div>

  <div class="test-card pass" onclick="this.classList.toggle('open')">
    <div class="test-header">
      <div>
        <h3>Filter (allow ICMP rule) - afpacket</h3>
        <div class="desc">ACL default_action=drop, one rule allow protocol=icmp. Expect RX>0, TX>0, Dropped<=2.</div>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="badge pass">PASS</span>
        <span class="toggle-icon">&#9654;</span>
      </div>
    </div>
    <div class="test-body">
      <div class="section-title">Configuration</div>
      <table class="info-table">
        <tr><th>Capture Mode</th><th>Workers</th><th>Input Interface</th><th>Output Interface</th></tr>
        <tr><td>afpacket</td><td>2</td><td>veth_src_host</td><td>veth_dst_host</td></tr>
      </table>

      <div class="section-title">Traffic Injected by Test</div>
      <table class="info-table">
        <tr><th>Type</th><th>Pings Sent</th><th>Source</th><th>Destination</th><th>Expected Raw Frames</th></tr>
        <tr><td>ICMP ping</td><td>20</td><td>n/a</td><td>n/a</td><td>~50 (requests + replies + ARP)</td></tr>
      </table>

      <div class="section-title">Results</div>
      <div class="detail-grid">
        <div class="detail-item">
          <div class="label">Raw Frames Captured</div>
          <div class="val highlight">41</div>
          <div class="sublabel">All frames on input iface (both directions + ARP)</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Forwarded</div>
          <div class="val highlight">40</div>
          <div class="sublabel">Frames sent to output interface by vasn_tap</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Dropped</div>
          <div class="val">1</div>
          <div class="sublabel">Captured but not forwarded (no output or error)</div>
        </div>
        <div class="detail-item">
          <div class="label">Received at Destination</div>
          <div class="val">0</div>
          <div class="sublabel">Packets verified by tcpdump in ns_dst</div>
        </div>
        <div class="detail-item">
          <div class="label">Duration</div>
          <div class="val">5s</div>
        </div>
      </div>
    </div>
  </div>

  <div class="test-card pass" onclick="this.classList.toggle('open')">
    <div class="test-header">
      <div>
        <h3>Filter (allow ICMP rule) - ebpf</h3>
        <div class="desc">ACL default_action=drop, one rule allow protocol=icmp. Expect RX>0, TX>0, Dropped<=2.</div>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="badge pass">PASS</span>
        <span class="toggle-icon">&#9654;</span>
      </div>
    </div>
    <div class="test-body">
      <div class="section-title">Configuration</div>
      <table class="info-table">
        <tr><th>Capture Mode</th><th>Workers</th><th>Input Interface</th><th>Output Interface</th></tr>
        <tr><td>ebpf</td><td>1</td><td>veth_src_host</td><td>veth_dst_host</td></tr>
      </table>

      <div class="section-title">Traffic Injected by Test</div>
      <table class="info-table">
        <tr><th>Type</th><th>Pings Sent</th><th>Source</th><th>Destination</th><th>Expected Raw Frames</th></tr>
        <tr><td>ICMP ping</td><td>20</td><td>n/a</td><td>n/a</td><td>~50 (requests + replies + ARP)</td></tr>
      </table>

      <div class="section-title">Results</div>
      <div class="detail-grid">
        <div class="detail-item">
          <div class="label">Raw Frames Captured</div>
          <div class="val highlight">42</div>
          <div class="sublabel">All frames on input iface (both directions + ARP)</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Forwarded</div>
          <div class="val highlight">40</div>
          <div class="sublabel">Frames sent to output interface by vasn_tap</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Dropped</div>
          <div class="val">2</div>
          <div class="sublabel">Captured but not forwarded (no output or error)</div>
        </div>
        <div class="detail-item">
          <div class="label">Received at Destination</div>
          <div class="val">0</div>
          <div class="sublabel">Packets verified by tcpdump in ns_dst</div>
        </div>
        <div class="detail-item">
          <div class="label">Duration</div>
          <div class="val">4s</div>
        </div>
      </div>
    </div>
  </div>

  <div class="test-card fail" onclick="this.classList.toggle('open')">
    <div class="test-header">
      <div>
        <h3>Filter (drop ICMP rule) - afpacket</h3>
        <div class="desc">ACL default_action=allow, one rule drop protocol=icmp. Expect RX>0, TX<=2, Dropped>0.</div>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="badge fail">FAIL</span>
        <span class="toggle-icon">&#9654;</span>
      </div>
    </div>
    <div class="test-body">
      <div class="section-title">Configuration</div>
      <table class="info-table">
        <tr><th>Capture Mode</th><th>Workers</th><th>Input Interface</th><th>Output Interface</th></tr>
        <tr><td>afpacket</td><td>2</td><td>veth_src_host</td><td>veth_dst_host</td></tr>
      </table>

      <div class="section-title">Traffic Injected by Test</div>
      <table class="info-table">
        <tr><th>Type</th><th>Pings Sent</th><th>Source</th><th>Destination</th><th>Expected Raw Frames</th></tr>
        <tr><td>ICMP ping</td><td>20</td><td>n/a</td><td>n/a</td><td>~50 (requests + replies + ARP)</td></tr>
      </table>

      <div class="section-title">Results</div>
      <div class="detail-grid">
        <div class="detail-item">
          <div class="label">Raw Frames Captured</div>
          <div class="val highlight">43</div>
          <div class="sublabel">All frames on input iface (both directions + ARP)</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Forwarded</div>
          <div class="val highlight">3</div>
          <div class="sublabel">Frames sent to output interface by vasn_tap</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Dropped</div>
          <div class="val">40</div>
          <div class="sublabel">Captured but not forwarded (no output or error)</div>
        </div>
        <div class="detail-item">
          <div class="label">Received at Destination</div>
          <div class="val">0</div>
          <div class="sublabel">Packets verified by tcpdump in ns_dst</div>
        </div>
        <div class="detail-item">
          <div class="label">Duration</div>
          <div class="val">4s</div>
        </div>
      </div>
      <div class="error-box">
        <div class="error-label">Error Details</div>
        <div>With drop-icmp rule expected RX>0, TX<=2, Dropped>0; got RX=43, TX=3, Dropped=40</div>
      </div>
    </div>
  </div>

  <div class="test-card pass" onclick="this.classList.toggle('open')">
    <div class="test-header">
      <div>
        <h3>Filter (drop ICMP rule) - ebpf</h3>
        <div class="desc">ACL default_action=allow, one rule drop protocol=icmp. Expect RX>0, TX<=2, Dropped>0.</div>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="badge pass">PASS</span>
        <span class="toggle-icon">&#9654;</span>
      </div>
    </div>
    <div class="test-body">
      <div class="section-title">Configuration</div>
      <table class="info-table">
        <tr><th>Capture Mode</th><th>Workers</th><th>Input Interface</th><th>Output Interface</th></tr>
        <tr><td>ebpf</td><td>1</td><td>veth_src_host</td><td>veth_dst_host</td></tr>
      </table>

      <div class="section-title">Traffic Injected by Test</div>
      <table class="info-table">
        <tr><th>Type</th><th>Pings Sent</th><th>Source</th><th>Destination</th><th>Expected Raw Frames</th></tr>
        <tr><td>ICMP ping</td><td>20</td><td>n/a</td><td>n/a</td><td>~50 (requests + replies + ARP)</td></tr>
      </table>

      <div class="section-title">Results</div>
      <div class="detail-grid">
        <div class="detail-item">
          <div class="label">Raw Frames Captured</div>
          <div class="val highlight">40</div>
          <div class="sublabel">All frames on input iface (both directions + ARP)</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Forwarded</div>
          <div class="val highlight">0</div>
          <div class="sublabel">Frames sent to output interface by vasn_tap</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Dropped</div>
          <div class="val">40</div>
          <div class="sublabel">Captured but not forwarded (no output or error)</div>
        </div>
        <div class="detail-item">
          <div class="label">Received at Destination</div>
          <div class="val">0</div>
          <div class="sublabel">Packets verified by tcpdump in ns_dst</div>
        </div>
        <div class="detail-item">
          <div class="label">Duration</div>
          <div class="val">5s</div>
        </div>
      </div>
    </div>
  </div>

  <div class="test-card pass" onclick="this.classList.toggle('open')">
    <div class="test-header">
      <div>
        <h3>Filter (drop all) - eBPF</h3>
        <div class="desc">Run with ACL config default_action=drop, rules=[]. Expect TX=0, Dropped>0.</div>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="badge pass">PASS</span>
        <span class="toggle-icon">&#9654;</span>
      </div>
    </div>
    <div class="test-body">
      <div class="section-title">Configuration</div>
      <table class="info-table">
        <tr><th>Capture Mode</th><th>Workers</th><th>Input Interface</th><th>Output Interface</th></tr>
        <tr><td>ebpf</td><td>1</td><td>veth_src_host</td><td>veth_dst_host</td></tr>
      </table>

      <div class="section-title">Traffic Injected by Test</div>
      <table class="info-table">
        <tr><th>Type</th><th>Pings Sent</th><th>Source</th><th>Destination</th><th>Expected Raw Frames</th></tr>
        <tr><td>ICMP ping</td><td>20</td><td>n/a</td><td>n/a</td><td>~50 (requests + replies + ARP)</td></tr>
      </table>

      <div class="section-title">Results</div>
      <div class="detail-grid">
        <div class="detail-item">
          <div class="label">Raw Frames Captured</div>
          <div class="val highlight">43</div>
          <div class="sublabel">All frames on input iface (both directions + ARP)</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Forwarded</div>
          <div class="val highlight">0</div>
          <div class="sublabel">Frames sent to output interface by vasn_tap</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Dropped</div>
          <div class="val">43</div>
          <div class="sublabel">Captured but not forwarded (no output or error)</div>
        </div>
        <div class="detail-item">
          <div class="label">Received at Destination</div>
          <div class="val">2</div>
          <div class="sublabel">Packets verified by tcpdump in ns_dst</div>
        </div>
        <div class="detail-item">
          <div class="label">Duration</div>
          <div class="val">10s</div>
        </div>
      </div>
    </div>
  </div>

  <div class="test-card fail" onclick="this.classList.toggle('open')">
    <div class="test-header">
      <div>
        <h3>Filter (IP CIDR) - afpacket</h3>
        <div class="desc">ACL default_action=drop, one rule allow ip_src 192.168.200.0/24. Expect RX>0, TX>0, Dropped=0.</div>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="badge fail">FAIL</span>
        <span class="toggle-icon">&#9654;</span>
      </div>
    </div>
    <div class="test-body">
      <div class="section-title">Configuration</div>
      <table class="info-table">
        <tr><th>Capture Mode</th><th>Workers</th><th>Input Interface</th><th>Output Interface</th></tr>
        <tr><td>afpacket</td><td>2</td><td>veth_src_host</td><td>veth_dst_host</td></tr>
      </table>

      <div class="section-title">Traffic Injected by Test</div>
      <table class="info-table">
        <tr><th>Type</th><th>Pings Sent</th><th>Source</th><th>Destination</th><th>Expected Raw Frames</th></tr>
        <tr><td>ICMP ping</td><td>20</td><td>n/a</td><td>n/a</td><td>~50 (requests + replies + ARP)</td></tr>
      </table>

      <div class="section-title">Results</div>
      <div class="detail-grid">
        <div class="detail-item">
          <div class="label">Raw Frames Captured</div>
          <div class="val highlight">42</div>
          <div class="sublabel">All frames on input iface (both directions + ARP)</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Forwarded</div>
          <div class="val highlight">40</div>
          <div class="sublabel">Frames sent to output interface by vasn_tap</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Dropped</div>
          <div class="val">2</div>
          <div class="sublabel">Captured but not forwarded (no output or error)</div>
        </div>
        <div class="detail-item">
          <div class="label">Received at Destination</div>
          <div class="val">0</div>
          <div class="sublabel">Packets verified by tcpdump in ns_dst</div>
        </div>
        <div class="detail-item">
          <div class="label">Duration</div>
          <div class="val">4s</div>
        </div>
      </div>
      <div class="error-box">
        <div class="error-label">Error Details</div>
        <div>With ip_src 192.168.200.0/24 rule expected RX>0, TX>0, Dropped=0; got RX=42, TX=40, Dropped=2</div>
      </div>
    </div>
  </div>

  <div class="test-card pass" onclick="this.classList.toggle('open')">
    <div class="test-header">
      <div>
        <h3>Filter (IP CIDR) - ebpf</h3>
        <div class="desc">ACL default_action=drop, one rule allow ip_src 192.168.200.0/24. Expect RX>0, TX>0, Dropped=0.</div>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="badge pass">PASS</span>
        <span class="toggle-icon">&#9654;</span>
      </div>
    </div>
    <div class="test-body">
      <div class="section-title">Configuration</div>
      <table class="info-table">
        <tr><th>Capture Mode</th><th>Workers</th><th>Input Interface</th><th>Output Interface</th></tr>
        <tr><td>ebpf</td><td>1</td><td>veth_src_host</td><td>veth_dst_host</td></tr>
      </table>

      <div class="section-title">Traffic Injected by Test</div>
      <table class="info-table">
        <tr><th>Type</th><th>Pings Sent</th><th>Source</th><th>Destination</th><th>Expected Raw Frames</th></tr>
        <tr><td>ICMP ping</td><td>20</td><td>n/a</td><td>n/a</td><td>~50 (requests + replies + ARP)</td></tr>
      </table>

      <div class="section-title">Results</div>
      <div class="detail-grid">
        <div class="detail-item">
          <div class="label">Raw Frames Captured</div>
          <div class="val highlight">40</div>
          <div class="sublabel">All frames on input iface (both directions + ARP)</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Forwarded</div>
          <div class="val highlight">40</div>
          <div class="sublabel">Frames sent to output interface by vasn_tap</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Dropped</div>
          <div class="val">0</div>
          <div class="sublabel">Captured but not forwarded (no output or error)</div>
        </div>
        <div class="detail-item">
          <div class="label">Received at Destination</div>
          <div class="val">0</div>
          <div class="sublabel">Packets verified by tcpdump in ns_dst</div>
        </div>
        <div class="detail-item">
          <div class="label">Duration</div>
          <div class="val">4s</div>
        </div>
      </div>
    </div>
  </div>

  <div class="test-card pass" onclick="this.classList.toggle('open')">
    <div class="test-header">
      <div>
        <h3>Graceful Shutdown - afpacket</h3>
        <div class="desc">Send SIGINT in afpacket mode while 50 ICMP pings are in flight. Verify vasn_tap prints cleanup messages and exits cleanly.</div>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="badge pass">PASS</span>
        <span class="toggle-icon">&#9654;</span>
      </div>
    </div>
    <div class="test-body">
      <div class="section-title">Configuration</div>
      <table class="info-table">
        <tr><th>Capture Mode</th><th>Workers</th><th>Input Interface</th><th>Output Interface</th></tr>
        <tr><td>afpacket</td><td>2</td><td>veth_src_host</td><td>(none - drop mode)</td></tr>
      </table>

      <div class="section-title">Traffic Injected by Test</div>
      <table class="info-table">
        <tr><th>Type</th><th>Pings Sent</th><th>Source</th><th>Destination</th><th>Expected Raw Frames</th></tr>
        <tr><td>ICMP ping (background)</td><td>50</td><td>ns_src (192.168.200.1)</td><td>host (192.168.200.2)</td><td>~110 (requests + replies + ARP)</td></tr>
      </table>

      <div class="section-title">Results</div>
      <div class="detail-grid">
        <div class="detail-item">
          <div class="label">Raw Frames Captured</div>
          <div class="val highlight">39</div>
          <div class="sublabel">All frames on input iface (both directions + ARP)</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Forwarded</div>
          <div class="val highlight">0</div>
          <div class="sublabel">Frames sent to output interface by vasn_tap</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Dropped</div>
          <div class="val">0</div>
          <div class="sublabel">Captured but not forwarded (no output or error)</div>
        </div>
        <div class="detail-item">
          <div class="label">Received at Destination</div>
          <div class="val">0</div>
          <div class="sublabel">Packets verified by tcpdump in ns_dst</div>
        </div>
        <div class="detail-item">
          <div class="label">Duration</div>
          <div class="val">3s</div>
        </div>
      </div>
      <div class="note-box">
        <div class="note-label">Why do the numbers differ from pings sent?</div>
        <div>SIGINT sent after 2s of traffic in afpacket mode. Clean shutdown verified by checking for Cleaning up and Done messages in output.</div>
      </div>
      <div class="section-title">Shutdown Verification</div>
      <table class="info-table">
        <tr><th>Check</th><th>Result</th></tr>
        <tr><td>Exit code</td><td>0</td></tr>
        <tr><td>"Cleaning up..." message</td><td>Yes</td></tr>
        <tr><td>"Done." message</td><td>Yes</td></tr>
        <tr><td>Final statistics printed</td><td>Yes</td></tr>
      </table>
    </div>
  </div>

  <div class="test-card pass" onclick="this.classList.toggle('open')">
    <div class="test-header">
      <div>
        <h3>Graceful Shutdown - ebpf</h3>
        <div class="desc">Send SIGINT in ebpf mode while 50 ICMP pings are in flight. Verify vasn_tap prints cleanup messages and exits cleanly.</div>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="badge pass">PASS</span>
        <span class="toggle-icon">&#9654;</span>
      </div>
    </div>
    <div class="test-body">
      <div class="section-title">Configuration</div>
      <table class="info-table">
        <tr><th>Capture Mode</th><th>Workers</th><th>Input Interface</th><th>Output Interface</th></tr>
        <tr><td>ebpf</td><td>2</td><td>veth_src_host</td><td>(none - drop mode)</td></tr>
      </table>

      <div class="section-title">Traffic Injected by Test</div>
      <table class="info-table">
        <tr><th>Type</th><th>Pings Sent</th><th>Source</th><th>Destination</th><th>Expected Raw Frames</th></tr>
        <tr><td>ICMP ping (background)</td><td>50</td><td>ns_src (192.168.200.1)</td><td>host (192.168.200.2)</td><td>~110 (requests + replies + ARP)</td></tr>
      </table>

      <div class="section-title">Results</div>
      <div class="detail-grid">
        <div class="detail-item">
          <div class="label">Raw Frames Captured</div>
          <div class="val highlight">40</div>
          <div class="sublabel">All frames on input iface (both directions + ARP)</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Forwarded</div>
          <div class="val highlight">0</div>
          <div class="sublabel">Frames sent to output interface by vasn_tap</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Dropped</div>
          <div class="val">0</div>
          <div class="sublabel">Captured but not forwarded (no output or error)</div>
        </div>
        <div class="detail-item">
          <div class="label">Received at Destination</div>
          <div class="val">0</div>
          <div class="sublabel">Packets verified by tcpdump in ns_dst</div>
        </div>
        <div class="detail-item">
          <div class="label">Duration</div>
          <div class="val">4s</div>
        </div>
      </div>
      <div class="note-box">
        <div class="note-label">Why do the numbers differ from pings sent?</div>
        <div>SIGINT sent after 2s of traffic in ebpf mode. Clean shutdown verified by checking for Cleaning up and Done messages in output.</div>
      </div>
      <div class="section-title">Shutdown Verification</div>
      <table class="info-table">
        <tr><th>Check</th><th>Result</th></tr>
        <tr><td>Exit code</td><td>0</td></tr>
        <tr><td>"Cleaning up..." message</td><td>Yes</td></tr>
        <tr><td>"Done." message</td><td>Yes</td></tr>
        <tr><td>Final statistics printed</td><td>Yes</td></tr>
      </table>
    </div>
  </div>

  <div class="test-card pass" onclick="this.classList.toggle('open')">
    <div class="test-header">
      <div>
        <h3>Multi-Worker (1 workers)</h3>
        <div class="desc">AF_PACKET mode with 1 worker thread(s): send 30 ICMP pings and verify RX/TX and packets at ns_dst</div>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="badge pass">PASS</span>
        <span class="toggle-icon">&#9654;</span>
      </div>
    </div>
    <div class="test-body">
      <div class="section-title">Configuration</div>
      <table class="info-table">
        <tr><th>Capture Mode</th><th>Workers</th><th>Input Interface</th><th>Output Interface</th></tr>
        <tr><td>afpacket</td><td>1</td><td>veth_src_host</td><td>veth_dst_host</td></tr>
      </table>

      <div class="section-title">Traffic Injected by Test</div>
      <table class="info-table">
        <tr><th>Type</th><th>Pings Sent</th><th>Source</th><th>Destination</th><th>Expected Raw Frames</th></tr>
        <tr><td>ICMP ping</td><td>30</td><td>ns_src (192.168.200.1)</td><td>host (192.168.200.2)</td><td>~70 (requests + replies + ARP)</td></tr>
      </table>

      <div class="section-title">Results</div>
      <div class="detail-grid">
        <div class="detail-item">
          <div class="label">Raw Frames Captured</div>
          <div class="val highlight">60</div>
          <div class="sublabel">All frames on input iface (both directions + ARP)</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Forwarded</div>
          <div class="val highlight">60</div>
          <div class="sublabel">Frames sent to output interface by vasn_tap</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Dropped</div>
          <div class="val">0</div>
          <div class="sublabel">Captured but not forwarded (no output or error)</div>
        </div>
        <div class="detail-item">
          <div class="label">Received at Destination</div>
          <div class="val">60</div>
          <div class="sublabel">Packets verified by tcpdump in ns_dst</div>
        </div>
        <div class="detail-item">
          <div class="label">Duration</div>
          <div class="val">4s</div>
        </div>
      </div>
      <div class="note-box">
        <div class="note-label">Why do the numbers differ from pings sent?</div>
        <div>RX counts raw frames on input (requests+replies+ARP). Pass requires packets captured in ns_dst (tcpdump on veth_dst_ns).</div>
      </div>
    </div>
  </div>

  <div class="test-card pass" onclick="this.classList.toggle('open')">
    <div class="test-header">
      <div>
        <h3>Tunnel GRE</h3>
        <div class="desc">GRE tunnel encap to 192.168.201.1 (ns_dst); expect Tunnel (GRE) packets sent > 0</div>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="badge pass">PASS</span>
        <span class="toggle-icon">&#9654;</span>
      </div>
    </div>
    <div class="test-body">
      <div class="section-title">Configuration</div>
      <table class="info-table">
        <tr><th>Capture Mode</th><th>Workers</th><th>Input Interface</th><th>Output Interface</th></tr>
        <tr><td>afpacket</td><td>2</td><td>veth_src_host</td><td>veth_dst_host</td></tr>
      </table>

      <div class="section-title">Traffic Injected by Test</div>
      <table class="info-table">
        <tr><th>Type</th><th>Pings Sent</th><th>Source</th><th>Destination</th><th>Expected Raw Frames</th></tr>
        <tr><td>ICMP ping</td><td>20</td><td>n/a</td><td>n/a</td><td>~50 (requests + replies + ARP)</td></tr>
      </table>

      <div class="section-title">Results</div>
      <div class="detail-grid">
        <div class="detail-item">
          <div class="label">Raw Frames Captured</div>
          <div class="val highlight">41</div>
          <div class="sublabel">All frames on input iface (both directions + ARP)</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Forwarded</div>
          <div class="val highlight">0</div>
          <div class="sublabel">Frames sent to output interface by vasn_tap</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Dropped</div>
          <div class="val">0</div>
          <div class="sublabel">Captured but not forwarded (no output or error)</div>
        </div>
        <div class="detail-item">
          <div class="label">Received at Destination</div>
          <div class="val">0</div>
          <div class="sublabel">Packets verified by tcpdump in ns_dst</div>
        </div>
        <div class="detail-item">
          <div class="label">Duration</div>
          <div class="val">5s</div>
        </div>
      </div>
    </div>
  </div>

  <div class="test-card pass" onclick="this.classList.toggle('open')">
    <div class="test-header">
      <div>
        <h3>Tunnel VXLAN</h3>
        <div class="desc">VXLAN tunnel encap to 192.168.201.1 (ns_dst); expect Tunnel (VXLAN) packets sent > 0</div>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="badge pass">PASS</span>
        <span class="toggle-icon">&#9654;</span>
      </div>
    </div>
    <div class="test-body">
      <div class="section-title">Configuration</div>
      <table class="info-table">
        <tr><th>Capture Mode</th><th>Workers</th><th>Input Interface</th><th>Output Interface</th></tr>
        <tr><td>afpacket</td><td>2</td><td>veth_src_host</td><td>veth_dst_host</td></tr>
      </table>

      <div class="section-title">Traffic Injected by Test</div>
      <table class="info-table">
        <tr><th>Type</th><th>Pings Sent</th><th>Source</th><th>Destination</th><th>Expected Raw Frames</th></tr>
        <tr><td>ICMP ping</td><td>20</td><td>n/a</td><td>n/a</td><td>~50 (requests + replies + ARP)</td></tr>
      </table>

      <div class="section-title">Results</div>
      <div class="detail-grid">
        <div class="detail-item">
          <div class="label">Raw Frames Captured</div>
          <div class="val highlight">40</div>
          <div class="sublabel">All frames on input iface (both directions + ARP)</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Forwarded</div>
          <div class="val highlight">0</div>
          <div class="sublabel">Frames sent to output interface by vasn_tap</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Dropped</div>
          <div class="val">0</div>
          <div class="sublabel">Captured but not forwarded (no output or error)</div>
        </div>
        <div class="detail-item">
          <div class="label">Received at Destination</div>
          <div class="val">0</div>
          <div class="sublabel">Packets verified by tcpdump in ns_dst</div>
        </div>
        <div class="detail-item">
          <div class="label">Duration</div>
          <div class="val">5s</div>
        </div>
      </div>
    </div>
  </div>

  <div class="test-card pass" onclick="this.classList.toggle('open')">
    <div class="test-header">
      <div>
        <h3>Multi-Worker (2 workers)</h3>
        <div class="desc">AF_PACKET mode with 2 worker thread(s): send 30 ICMP pings and verify RX/TX and packets at ns_dst</div>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="badge pass">PASS</span>
        <span class="toggle-icon">&#9654;</span>
      </div>
    </div>
    <div class="test-body">
      <div class="section-title">Configuration</div>
      <table class="info-table">
        <tr><th>Capture Mode</th><th>Workers</th><th>Input Interface</th><th>Output Interface</th></tr>
        <tr><td>afpacket</td><td>2</td><td>veth_src_host</td><td>veth_dst_host</td></tr>
      </table>

      <div class="section-title">Traffic Injected by Test</div>
      <table class="info-table">
        <tr><th>Type</th><th>Pings Sent</th><th>Source</th><th>Destination</th><th>Expected Raw Frames</th></tr>
        <tr><td>ICMP ping</td><td>30</td><td>ns_src (192.168.200.1)</td><td>host (192.168.200.2)</td><td>~70 (requests + replies + ARP)</td></tr>
      </table>

      <div class="section-title">Results</div>
      <div class="detail-grid">
        <div class="detail-item">
          <div class="label">Raw Frames Captured</div>
          <div class="val highlight">62</div>
          <div class="sublabel">All frames on input iface (both directions + ARP)</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Forwarded</div>
          <div class="val highlight">62</div>
          <div class="sublabel">Frames sent to output interface by vasn_tap</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Dropped</div>
          <div class="val">0</div>
          <div class="sublabel">Captured but not forwarded (no output or error)</div>
        </div>
        <div class="detail-item">
          <div class="label">Received at Destination</div>
          <div class="val">60</div>
          <div class="sublabel">Packets verified by tcpdump in ns_dst</div>
        </div>
        <div class="detail-item">
          <div class="label">Duration</div>
          <div class="val">4s</div>
        </div>
      </div>
      <div class="note-box">
        <div class="note-label">Why do the numbers differ from pings sent?</div>
        <div>RX counts raw frames on input (requests+replies+ARP). Pass requires packets captured in ns_dst (tcpdump on veth_dst_ns).</div>
      </div>
    </div>
  </div>

  <div class="test-card pass" onclick="this.classList.toggle('open')">
    <div class="test-header">
      <div>
        <h3>Multi-Worker (4 workers)</h3>
        <div class="desc">AF_PACKET mode with 4 worker thread(s): send 30 ICMP pings and verify RX/TX and packets at ns_dst</div>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="badge pass">PASS</span>
        <span class="toggle-icon">&#9654;</span>
      </div>
    </div>
    <div class="test-body">
      <div class="section-title">Configuration</div>
      <table class="info-table">
        <tr><th>Capture Mode</th><th>Workers</th><th>Input Interface</th><th>Output Interface</th></tr>
        <tr><td>afpacket</td><td>4</td><td>veth_src_host</td><td>veth_dst_host</td></tr>
      </table>

      <div class="section-title">Traffic Injected by Test</div>
      <table class="info-table">
        <tr><th>Type</th><th>Pings Sent</th><th>Source</th><th>Destination</th><th>Expected Raw Frames</th></tr>
        <tr><td>ICMP ping</td><td>30</td><td>ns_src (192.168.200.1)</td><td>host (192.168.200.2)</td><td>~70 (requests + replies + ARP)</td></tr>
      </table>

      <div class="section-title">Results</div>
      <div class="detail-grid">
        <div class="detail-item">
          <div class="label">Raw Frames Captured</div>
          <div class="val highlight">62</div>
          <div class="sublabel">All frames on input iface (both directions + ARP)</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Forwarded</div>
          <div class="val highlight">62</div>
          <div class="sublabel">Frames sent to output interface by vasn_tap</div>
        </div>
        <div class="detail-item">
          <div class="label">Frames Dropped</div>
          <div class="val">0</div>
          <div class="sublabel">Captured but not forwarded (no output or error)</div>
        </div>
        <div class="detail-item">
          <div class="label">Received at Destination</div>
          <div class="val">60</div>
          <div class="sublabel">Packets verified by tcpdump in ns_dst</div>
        </div>
        <div class="detail-item">
          <div class="label">Duration</div>
          <div class="val">5s</div>
        </div>
      </div>
      <div class="note-box">
        <div class="note-label">Why do the numbers differ from pings sent?</div>
        <div>RX counts raw frames on input (requests+replies+ARP). Pass requires packets captured in ns_dst (tcpdump on veth_dst_ns).</div>
      </div>
    </div>
  </div>
</div>

<div class="footer">
  Generated by vasn_tap integration test suite
</div>

<script>
// Auto-expand failed tests
document.querySelectorAll('.test-card.fail').forEach(function(card) {
  card.classList.add('open');
});
</script>
</body>
</html>
